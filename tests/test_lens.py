"""
Process the options chain data.
"""
import pytest

from rysk_client.src.rysk_option_market import OptionChain

RAW_DATA_1 = (
    [1688112000, 1686297600, 1686902400],
    [
        (
            1688112000,
            [
                1700000000000000000000,
                1800000000000000000000,
                1900000000000000000000,
                2000000000000000000000,
                2100000000000000000000,
                2200000000000000000000,
                1600000000000000000000,
                1500000000000000000000,
            ],
            [
                (
                    1700000000000000000000,
                    (422835696395370582, 298815718, 500000, True, False),
                    (422835696395370582, 304320174, 500000, True, False),
                    843944520411168625,
                    -144300000000000000000,
                ),
                (
                    1800000000000000000000,
                    (368092714837837288, 112270427, 500000, False, False),
                    (368092714837837288, 115080725, 500000, False, False),
                    701550808961229697,
                    9500000000000000000,
                ),
                (
                    1900000000000000000000,
                    (337554086090028786, 103452364, 500000, False, False),
                    (337554086090028786, 106765810, 500000, False, False),
                    472798780529828161,
                    -217100000000000000000,
                ),
                (
                    2000000000000000000000,
                    (342328098809008929, 74877247, 500000, False, False),
                    (342328098809008929, 77337255, 500000, False, False),
                    254014453162348274,
                    -386980000000000000000,
                ),
                (
                    2100000000000000000000,
                    (370579455615974699, 66028281, 500000, False, False),
                    (370579455615974699, 68030464, 500000, False, False),
                    129628265628227083,
                    -571860000000000000000,
                ),
                (
                    2200000000000000000000,
                    (406880452838993464, 28108256, 500000, True, False),
                    (406880452838993464, 29780922, 500000, True, False),
                    70319208060026996,
                    -499900000000000000000,
                ),
                (
                    1600000000000000000000,
                    (488642823283393992, 289321162, 500000, True, False),
                    (488642823283393992, 295230213, 500000, True, False),
                    916737492013287644,
                    0,
                ),
                (
                    1500000000000000000000,
                    (560247695244077118, 385178266, 500000, True, False),
                    (560247695244077118, 391666233, 500000, True, False),
                    953673598013448319,
                    0,
                ),
            ],
            [
                1700000000000000000000,
                1800000000000000000000,
                1900000000000000000000,
                2000000000000000000000,
                2100000000000000000000,
                2200000000000000000000,
                1600000000000000000000,
                1500000000000000000000,
            ],
            [
                (
                    1700000000000000000000,
                    (422835696395370582, 34083395, 500000, False, False),
                    (422835696395370582, 36199750, 500000, False, False),
                    -156055479588831375,
                    -222753219887523536000,
                ),
                (
                    1800000000000000000000,
                    (368092714837837288, 70464787, 500000, False, False),
                    (368092714837837288, 73421807, 500000, False, False),
                    -298449191038770303,
                    -236000000000000000000,
                ),
                (
                    1900000000000000000000,
                    (337554086090028786, 72060675, 500000, False, False),
                    (337554086090028786, 76177814, 500000, False, False),
                    -527201219470171839,
                    -520000000000000000,
                ),
                (
                    2000000000000000000000,
                    (342328098809008929, 142234230, 500000, True, False),
                    (342328098809008929, 147820500, 500000, True, False),
                    -745985546837651727,
                    -6540000000000000000,
                ),
                (
                    2100000000000000000000,
                    (370579455615974699, 226271247, 500000, True, False),
                    (370579455615974699, 232914159, 500000, True, False),
                    -870371734371772918,
                    0,
                ),
                (
                    2200000000000000000000,
                    (406880452838993464, 320785863, 500000, True, False),
                    (406880452838993464, 328219521, 500000, True, False),
                    -929680791939973004,
                    0,
                ),
                (
                    1600000000000000000000,
                    (488642823283393992, 20418826, 500000, True, False),
                    (488642823283393992, 22082196, 500000, True, False),
                    -83262507986712357,
                    -251414708043730166000,
                ),
                (
                    1500000000000000000000,
                    (560247695244077118, 18709113, 500000, True, False),
                    (560247695244077118, 20121109, 500000, True, False),
                    -46326401986551682,
                    -393500000000000000000,
                ),
            ],
            1881428510000000000000,
        ),
        (
            1686297600,
            [
                2000000000000000000000,
                1950000000000000000000,
                1900000000000000000000,
                1850000000000000000000,
                1800000000000000000000,
                1750000000000000000000,
                1700000000000000000000,
                1650000000000000000000,
                2050000000000000000000,
                2100000000000000000000,
                2200000000000000000000,
            ],
            [
                (
                    2000000000000000000000,
                    (435453762358623467, 5173808, 500000, True, False),
                    (435453762358623467, 5259370, 500000, True, False),
                    33317779036325126,
                    -583030000000000000000,
                ),
                (
                    1950000000000000000000,
                    (381254486712069939, 10562941, 500000, False, False),
                    (381254486712069939, 10690221, 500000, False, False),
                    110599619712283008,
                    -413940000000000000000,
                ),
                (
                    1900000000000000000000,
                    (354532978955201085, 17810749, 500000, False, False),
                    (354532978955201085, 18038540, 500000, False, False),
                    362701592372539618,
                    -126100000000000000000,
                ),
                (
                    1850000000000000000000,
                    (386833995198749165, 57724492, 500000, True, False),
                    (386833995198749165, 58186279, 500000, True, False),
                    722324527989140193,
                    -120800000000000000000,
                ),
                (
                    1800000000000000000000,
                    (458090214173689882, 116281732, 500000, True, False),
                    (458090214173689882, 116976981, 500000, True, False),
                    901809288409430935,
                    -113330000000000000000,
                ),
                (
                    1750000000000000000000,
                    (540456218683247092, 132271626, 500000, True, False),
                    (540456218683247092, 133041119, 500000, True, False),
                    963139360768915894,
                    0,
                ),
                (
                    1700000000000000000000,
                    (625555919440032839, 181539932, 500000, True, False),
                    (625555919440032839, 182465818, 500000, True, False),
                    984702092993702736,
                    0,
                ),
                (
                    1650000000000000000000,
                    (711479691649382863, 231207787, 500000, True, False),
                    (711479691649382863, 232286943, 500000, True, False),
                    993067139475775745,
                    0,
                ),
                (
                    2050000000000000000000,
                    (495233636136308020, 549404, 500000, True, True),
                    (495233636136308020, 613188, 500000, True, True),
                    11721399796799652,
                    -210000000000000000000,
                ),
                (
                    2100000000000000000000,
                    (554556878390682252, 116124, 500000, True, True),
                    (554556878390682252, 176276, 500000, True, True),
                    4762313918357459,
                    0,
                ),
                (
                    2200000000000000000000,
                    (666976377147772191, 27942, 500000, True, True),
                    (666976377147772191, 86623, 500000, True, True),
                    1078196768980884,
                    0,
                ),
            ],
            [
                2000000000000000000000,
                1950000000000000000000,
                1900000000000000000000,
                1850000000000000000000,
                1800000000000000000000,
                1750000000000000000000,
                1700000000000000000000,
                1650000000000000000000,
                2050000000000000000000,
                2100000000000000000000,
                2200000000000000000000,
            ],
            [
                (
                    2000000000000000000000,
                    (435453762358623467, 118960835, 500000, True, False),
                    (435453762358623467, 119803904, 500000, True, False),
                    -966682220963674874,
                    0,
                ),
                (
                    1950000000000000000000,
                    (381254486712069939, 53935608, 500000, True, False),
                    (381254486712069939, 54465830, 500000, True, False),
                    -889400380287716992,
                    94140000000000000000,
                ),
                (
                    1900000000000000000000,
                    (354532978955201085, 48850108, 500000, False, False),
                    (354532978955201085, 49332377, 500000, False, False),
                    -637298407627460382,
                    -158190000000000000000,
                ),
                (
                    1850000000000000000000,
                    (386833995198749165, 17596834, 500000, False, False),
                    (386833995198749165, 17834107, 500000, False, False),
                    -277675472010859807,
                    -199200000000000000000,
                ),
                (
                    1800000000000000000000,
                    (458090214173689882, 20404299, 500000, False, False),
                    (458090214173689882, 20575986, 500000, False, False),
                    -98190711590569065,
                    -593750000000000000000,
                ),
                (
                    1750000000000000000000,
                    (540456218683247092, 8281958, 500000, True, False),
                    (540456218683247092, 8387446, 500000, True, False),
                    -36860639231084106,
                    -617500000000000000000,
                ),
                (
                    1700000000000000000000,
                    (625555919440032839, 3146546, 500000, True, True),
                    (625555919440032839, 3224732, 500000, True, True),
                    -15297907006297264,
                    -580000000000000000000,
                ),
                (
                    1650000000000000000000,
                    (711479691649382863, 319406, 500000, True, True),
                    (711479691649382863, 383214, 500000, True, True),
                    -6932860524224256,
                    -100000000000000000000,
                ),
                (
                    2050000000000000000000,
                    (495233636136308020, 168362202, 500000, True, False),
                    (495233636136308020, 169368300, 500000, True, False),
                    -988278600203200348,
                    0,
                ),
                (
                    2100000000000000000000,
                    (554556878390682252, 218122887, 500000, True, False),
                    (554556878390682252, 219286930, 500000, True, False),
                    -995237686081642542,
                    0,
                ),
                (
                    2200000000000000000000,
                    (666976377147772191, 317887191, 500000, True, False),
                    (666976377147772191, 319363544, 500000, True, False),
                    -998921803231019117,
                    0,
                ),
            ],
            1881428510000000000000,
        ),
        (
            1686902400,
            [
                2050000000000000000000,
                2000000000000000000000,
                1950000000000000000000,
                1900000000000000000000,
                1850000000000000000000,
                1800000000000000000000,
                1750000000000000000000,
            ],
            [
                (
                    2050000000000000000000,
                    (388139262814181288, 16003217, 500000, True, False),
                    (388139262814181288, 16571543, 500000, True, False),
                    86742977714886889,
                    -401000000000000000000,
                ),
                (
                    2000000000000000000000,
                    (367033166433360443, 52713239, 500000, False, False),
                    (367033166433360443, 53489762, 500000, False, False),
                    154684589906373108,
                    -585000000000000000000,
                ),
                (
                    1950000000000000000000,
                    (353840967250697299, 57046383, 500000, False, False),
                    (353840967250697299, 57995617, 500000, False, False),
                    273173036258763155,
                    -402700000000000000000,
                ),
                (
                    1900000000000000000000,
                    (354022108490258258, 60569582, 500000, False, False),
                    (354022108490258258, 61765186, 500000, False, False),
                    445102006973380384,
                    -200340000000000000000,
                ),
                (
                    1850000000000000000000,
                    (370255477933032290, 56513501, 500000, False, False),
                    (370255477933032290, 57553175, 500000, False, False),
                    628107958572218849,
                    27040000000000000000,
                ),
                (
                    1800000000000000000000,
                    (399468798241980144, 141739015, 500000, True, False),
                    (399468798241980144, 143681641, 500000, True, False),
                    770937634819946411,
                    -128250000000000000000,
                ),
                (
                    1750000000000000000000,
                    (436607625078198419, 140880464, 500000, True, False),
                    (436607625078198419, 142984496, 500000, True, False),
                    862853207555625638,
                    0,
                ),
            ],
            [
                2050000000000000000000,
                2000000000000000000000,
                1950000000000000000000,
                1900000000000000000000,
                1850000000000000000000,
                1800000000000000000000,
                1750000000000000000000,
            ],
            [
                (
                    2050000000000000000000,
                    (388139262814181288, 170862920, 500000, True, False),
                    (388139262814181288, 173604277, 500000, True, False),
                    -913257022285113111,
                    0,
                ),
                (
                    2000000000000000000000,
                    (367033166433360443, 125100440, 500000, True, False),
                    (367033166433360443, 127540855, 500000, True, False),
                    -845315410093626892,
                    0,
                ),
                (
                    1950000000000000000000,
                    (353840967250697299, 110430543, 500000, True, False),
                    (353840967250697299, 112571524, 500000, True, False),
                    -726826963741236846,
                    -91000000000000000000,
                ),
                (
                    1900000000000000000000,
                    (354022108490258258, 76367317, 500000, False, False),
                    (354022108490258258, 78040656, 500000, False, False),
                    -554897993026619616,
                    -136600000000000000000,
                ),
                (
                    1850000000000000000000,
                    (370255477933032290, 74325493, 500000, False, False),
                    (370255477933032290, 75642155, 500000, False, False),
                    -371892041427781151,
                    -310400000000000000000,
                ),
                (
                    1800000000000000000000,
                    (399468798241980144, 59001141, 500000, False, False),
                    (399468798241980144, 60004532, 500000, False, False),
                    -229062365180053589,
                    -418000000000000000000,
                ),
                (
                    1750000000000000000000,
                    (436607625078198419, 22680165, 500000, False, False),
                    (436607625078198419, 23395005, 500000, False, False),
                    -137146792444374363,
                    -283000000000000000000,
                ),
            ],
            1881428510000000000000,
        ),
    ],
)


RAW_DATA_2 = (
    [1690531200],
    [
        (
            1690531200,
            [
                1650000000000000000000,
                1700000000000000000000,
                1750000000000000000000,
                1800000000000000000000,
                1850000000000000000000,
                1900000000000000000000,
                1950000000000000000000,
                2000000000000000000000,
                2100000000000000000000,
            ],
            [
                (
                    1650000000000000000000,
                    (541407594104046617, 287913222, 500000, True, False),
                    (541407594104046617, 291607833, 500000, True, False),
                    944961453790407937,
                    0,
                    ("0x7D229a28Ab173168B735850BC53b9c2612F4aaae", 0),
                    ("0x13A1A1802357cB569814089Dc9C63C910880B682", 0),
                ),
                (
                    1700000000000000000000,
                    (506717260386628500, 240505641, 500000, True, False),
                    (506717260386628500, 243953264, 500000, True, False),
                    917857101250245624,
                    0,
                    ("0xBe60C4772ED49F1B5B3759fbA69AB5B632E43bc2", 0),
                    ("0xe7d6Db116392dC69f2318a7a22d00A50e1DCAeB8", 0),
                ),
                (
                    1750000000000000000000,
                    (475182710440301878, 194591696, 500000, True, False),
                    (475182710440301878, 197767277, 500000, True, False),
                    876223867560415099,
                    0,
                    ("0x15735664a461507Ea4E80D525f04Cd1074252593", 0),
                    ("0xc47409fB4101B653Ce4eEeaabCD26Fb247AA8761", 0),
                ),
                (
                    1800000000000000000000,
                    (448021293081398576, 151179977, 500000, True, False),
                    (448021293081398576, 154046658, 500000, True, False),
                    813442139068481209,
                    0,
                    ("0xBb26153d7Be75e31f5B2E856bA6cb4A7D5658829", 0),
                    ("0x7534F0f4d513E750D69e3C487a2d180Fe46B1669", 0),
                ),
                (
                    1850000000000000000000,
                    (426958128003314174, 108660514, 500000, True, False),
                    (426958128003314174, 110479560, 500000, True, False),
                    723490838486461543,
                    10000000000000000000,
                    ("0x158761CBefCDFE190790e8e8A988d26a043A7af9", 1000000000),
                    ("0x7802F15AF43aaDCf28EdA1f4d1873Bd40DB132DA", 0),
                ),
                (
                    1900000000000000000000,
                    (413925654296025220, 110754710, 500000, False, False),
                    (413925654296025220, 112963680, 500000, False, False),
                    606735625980960539,
                    -120000000000000000000,
                    ("0x5Be3730d007ABa37C56442369A78fC0ab5778229", 0),
                    ("0x0E44dD969bB077772134fb8C8351a902699B6b38", 0),
                ),
                (
                    1950000000000000000000,
                    (410134511584181791, 54300971, 500000, False, False),
                    (410134511584181791, 56043476, 500000, False, False),
                    475984253263611816,
                    -11000000000000000000,
                    ("0x797EfAcf3cF895441FEf503147eB8003F9061f5d", 0),
                    ("0xe2b36EE8Df4E12755092E6D0040478daAa376Aea", 0),
                ),
                (
                    2000000000000000000000,
                    (415094581462555654, 34432642, 500000, False, False),
                    (415094581462555654, 35860434, 500000, False, False),
                    352303956265175735,
                    -1000000000000000000,
                    ("0xaA563B94dbe0Deef03848d06F8B2A0E86C30C34f", 0),
                    ("0x32a0B038bd5702dE28748950098c6fC2B8c1ECf9", 0),
                ),
                (
                    2100000000000000000000,
                    (442925377533728605, 14708284, 500000, False, False),
                    (442925377533728605, 15713351, 500000, False, False),
                    176433371930543912,
                    0,
                    ("0x220f04979695ff91250958e8328C6960D6E26b36", 0),
                    ("0x18E12Cf09305483e586Bf42f1676ac174F02d7A5", 0),
                ),
            ],
            [
                1650000000000000000000,
                1700000000000000000000,
                1750000000000000000000,
                1800000000000000000000,
                1850000000000000000000,
                1900000000000000000000,
                1950000000000000000000,
                2000000000000000000000,
                2100000000000000000000,
            ],
            [
                (
                    1650000000000000000000,
                    (541407594104046617, 4755079, 500000, True, False),
                    (541407594104046617, 5459253, 500000, True, False),
                    -55038546209592064,
                    0,
                    ("0xc2c48ca91e03D34286E85Be2bCC5830D9aB5B448", 0),
                    ("0x9103F774A1d68E28916Bdda635F847Bd97f34656", 0),
                ),
                (
                    1700000000000000000000,
                    (506717260386628500, 7126771, 500000, True, False),
                    (506717260386628500, 7928263, 500000, True, False),
                    -82142898749754377,
                    0,
                    ("0x378C7d0C37C8385b302c27c498177633F2677E61", 0),
                    ("0xca73cDc17113b0DB2dB16D3f6E167921f9B37a28", 0),
                ),
                (
                    1750000000000000000000,
                    (475182710440301878, 10957675, 500000, False, False),
                    (475182710440301878, 11900279, 500000, False, False),
                    -123776132439584902,
                    0,
                    ("0x7334122647354df18AA0e80C9253302fE2C0C959", 0),
                    ("0x3996BdaEC9bB5104ECBE2ba5508270D1c5F7295A", 0),
                ),
                (
                    1800000000000000000000,
                    (448021293081398576, 17240117, 500000, False, False),
                    (448021293081398576, 18388350, 500000, False, False),
                    -186557860931518791,
                    0,
                    ("0xFA5D06994a4f79eD314813ddEb3E1E9A42f27E7D", 0),
                    ("0x9e0A6A7a3565916D66A0a7Fd74e3e46a4d5C17F0", 0),
                ),
                (
                    1850000000000000000000,
                    (426958128003314174, 37496168, 500000, False, False),
                    (426958128003314174, 38965014, 500000, False, False),
                    -276509161513538458,
                    -100000000000000000000,
                    ("0x2C67e9d69A9320840217350348ca5d0C6aC506da", 0),
                    ("0x92c0079Ca92B1197090544417E0Ea02D25FB7dC5", 2000000000),
                ),
                (
                    1900000000000000000000,
                    (413925654296025220, 43290836, 500000, False, False),
                    (413925654296025220, 44486740, 500000, False, False),
                    -393264374019039462,
                    3000000000000000000,
                    ("0x1Ae0de9b42c73795E3a99a0323A9b6fE07DDfbB3", 300000000),
                    ("0x5Db61Cb800F4015d113E67D20D0903F0258F0E14", 0),
                ),
                (
                    1950000000000000000000,
                    (410134511584181791, 67358869, 500000, False, False),
                    (410134511584181791, 69636169, 500000, False, False),
                    -524015746736388184,
                    0,
                    ("0x18458Cd18915Cb15dd0116849449a0914a5A328B", 0),
                    ("0x755FeDE891D69e0E29De6D0Bb7Ef767f9e3d9854", 0),
                ),
                (
                    2000000000000000000000,
                    (415094581462555654, 98664118, 500000, False, False),
                    (415094581462555654, 101435592, 500000, False, False),
                    -647696043734824265,
                    0,
                    ("0x7Ec60c59108F464682AC8E9E8EC3C180E6e3d28d", 0),
                    ("0x92767F196d072C07d8Be9808fBc17FAb5e147288", 0),
                ),
                (
                    2100000000000000000000,
                    (442925377533728605, 178306075, 500000, True, False),
                    (442925377533728605, 181930938, 500000, True, False),
                    -823566628069456088,
                    0,
                    ("0x7B97312f229a3D1168545168E5A2006E2A5343C5", 0),
                    ("0x3D33634E3Aa067D9ba30F9797eefa4421b7A68eb", 0),
                ),
            ],
            1931675200000000000000,
        )
    ],
)


@pytest.fixture
def option_chain():
    """Return a OptionChain instance."""
    return OptionChain(RAW_DATA_1)


@pytest.mark.parametrize(
    "data",
    [
        RAW_DATA_1,
        RAW_DATA_2,
    ],
)
def test_parse_option_chain(data):
    """Test parsing the option chain."""
    OptionChain(data)


def test_parse_option_chain_expirations(option_chain):
    """Test parsing the expirations."""
    assert option_chain.expirations


def test_parse_option_chain_strike(option_chain):
    """Test parsing the expirations."""
    assert option_chain.strikes


def test_parse_option_chain_active_markets(option_chain):
    """Test parsing the expirations."""
    assert option_chain.active_markets


def test_current_price_expirations(option_chain):
    """Test parsing the expirations."""
    assert option_chain.current_price
